Algorithme Continuator

A l'initiation, créer quatre structures de données :

1) Une collection d'arbres préfixes.

2) Une structure récursive d'arbre préfixe.
Un noeud contient trois valeurs :
- une valeur de hauteur (MIDI),
- une collection de sous-noeuds,
- une collection de continuations.

3) Un dictionnaire de continuations.
L'index est un entier.
La valeur associée est une valeur de hauteur.

4) Une table de probabilités de transition.
La 1ère dimension représente la valeur de hauteur de la note actuelle.
La 2ème dimension représente la valeur de hauteur d'une possible note suivante.
La valeur de chaque cellule est un tuple constitué de 2 valeurs :
- un nombre entier, qui représentera le nombre d'occurrences d'une possible note suivante,
- un nombre réel, qui représentera la probabilité de transition correspondante.

Algorithmes :

Fonction Ecouter_séquence_jouée (liste_événements -- une liste ordonnées d'événements) :
	Pour i décroissant de l'index de l'avant dernier élément de liste_événements jusqu'au 1er élément :
		Appeler la fonction Insérer_noeud (i ème élément, i+1ème élément, liste des événements du 1er au i-1 ème, True) 
	Puis, appeler la fonction Générer_continuation (événement)

Fonction Insérer_noeud (événement_index, événement_continuation, liste_événements, estRacine?) :
	Si estRacine? est vrai et si il n'existe pas déjà un arbre dans la collection d'arbres préfixes ayant comme valeur la valeur de événement_index,
	Alors :
		Créer un nouveau noeud d'arbre préfixe ayant pour valeurs :
		- la hauteur de événement_index,
		- la collection de sous-noeuds restant vide,
		- une collection contenant index_continuation,
		Ajouter ce nouveau noeud à la collection d'arbres préfixes,
	Sinon :
    Puis, Insérer_noeud (événement_index, événement_continuation, liste_événements, estRacine?)
    on appelle la fonction Créer_sous_noeud_arbre_préfixe (sous_liste_événements_jusqu'à_l'avant_avant_dernier_élément, continuation)
et la valeur résultat retournée (le noeud créé) est ajouté à la collection de sous-noeuds.


Extraire dernier_événement, et avant_dernier_événement de la séquence liste_événements.
Rechercher dans la collection d'arbres préfixes, si il y a une racine dont la hauteur est égale à la hauteur de avant_dernier_événement.
Si c'est le cas, insérer de nouveaux arbres préfixes,
sinon créer de nouveaux arbres préfixe.


Fonction Insérer_nouvel_arbre préfixe (insertionP, liste_événements) :
Créer un nouvel arbre préfixe, son noeud initial ayant pour valeurs :
- la hauteur de l'avant-dernier événement (de liste_événements),
- la collection de sous-noeuds reste vide,
- une collection contenant une unique continuation,
qui est créée avec un nouvel index et a comme valeur la hauteur du dernier événement.
Cette continuation est ajoutée au dictionnaire de continuations.
Puis, si il reste encore des événements avant l'avant-dernier événement,
on appelle la fonction Créer_sous_noeud_arbre_préfixe (sous-liste des événements jusqu'à l'avant avant dernier élément, continuation)
et la valeur résultat retournée (le noeud créé) est ajouté à la collection de sous-noeuds.
